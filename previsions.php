<?php
$title="Prévisions";
$description="La page des prévisions ";
$h1="Choisir votre ville pour voir les previsions détaillées ";
require_once "./include/functions.inc.php";
require "./include/header.inc.php";


?>

    <section>
        <h2>Choisir votre région</h2>

        <!-- Image Map Generated by http://www.image-map.net/ -->
        <img src="./images/carte_regions_france.png" usemap="#image-map" style="display: block; margin: 0 auto;">

        <map name="image-map" id="formulaire">
            <area target="" alt="Nouvelle" title="Nouvelle" href="<?=$mode.$language?>&region=75#formulaire" coords="197,370,208,370,217,370,217,362,218,354,219,348,213,339,210,332,215,328,226,320,232,320,240,320,247,318,254,320,258,326,267,332,277,330,281,338,284,346,289,354,292,358,297,364,309,368,318,366,329,365,339,363,355,378,357,388,354,396,353,404,354,416,355,428,348,429,338,450,331,452,322,452,311,448,306,452,308,462,302,465,295,473,292,479,287,488,287,496,285,504,279,507,273,508,266,508,260,508,254,511,247,516,240,517,237,526,235,530,243,544,244,552,243,566,235,570,229,580,222,583,210,576,201,572,193,564,185,570,184,555,166,550,182,530,192,476,201,470,191,471,198,433,198,414,220,446,180,388,197,382,200,388,191,381,197,388,192,476,198,431,194,420" shape="poly">
            <area target="" alt="Occitanie" title="Occitanie" href="<?=$mode.$language?>&region=76#formulaire" coords="319,451,325,455,335,451,335,459,339,467,339,475,348,471,355,466,361,457,369,467,374,474,378,460,388,456,397,462,407,462,410,468,416,482,418,490,424,491,432,495,439,491,445,495,449,504,453,511,451,517,445,517,445,525,440,529,434,534,426,543,419,533,413,539,407,543,401,547,396,551,391,553,382,561,377,569,375,578,375,587,378,593,381,601,373,602,365,602,359,607,351,608,338,607,330,610,325,602,319,596,313,591,307,591,300,587,292,584,284,583,278,578,270,582,268,587,259,587,247,587,238,585,231,579,237,568,245,553,241,539,236,529,236,521,255,513,275,510,285,504,289,487,297,472,311,452,317,449" shape="poly">
            <area target="" alt="Provence-Alpes-Côte d'Azur" title="Provence-Alpes-Côte d'Azur" href="<?=$mode.$language?>&region=93#formulaire" coords="447,495,453,497,460,495,469,498,477,501,482,504,489,502,488,492,480,486,485,482,489,474,497,471,501,464,508,459,516,459,519,451,515,446,525,446,531,446,533,453,536,458,541,462,547,461,547,468,544,475,541,480,541,488,541,494,547,497,553,500,560,502,566,504,573,504,576,512,571,516,570,523,564,527,556,530,551,539,541,544,535,546,532,551,533,558,525,560,515,562,510,567,501,564,493,566,488,561,481,560,476,550,471,550,465,550,459,545,449,550,444,546,436,543,428,542,438,532,448,524,454,515,449,507" shape="poly">
            <area target="" alt="Auvergne" title="Auvergne" href="<?=$mode.$language?>&region=84#formulaire" coords="343,364,348,358,353,356,357,348,365,344,373,340,377,344,383,347,390,346,395,352,399,346,404,350,407,356,413,359,418,363,417,369,413,375,418,379,429,380,435,374,443,372,447,378,454,375,458,368,458,360,467,359,475,362,478,367,481,372,487,370,495,375,501,366,508,366,505,374,501,380,509,384,513,379,515,371,521,368,527,362,535,362,537,369,539,376,537,383,543,388,546,396,542,401,537,404,541,411,547,416,549,426,552,434,545,438,540,442,531,445,521,442,515,446,515,453,509,457,503,465,497,465,491,474,487,480,478,488,485,491,489,501,481,504,472,499,465,496,453,496,446,493,437,490,428,494,421,488,400,459,389,459,382,458,377,464,375,472,365,462,358,457,355,464,348,472,340,472,337,462,335,452,345,434,353,430,352,414,349,403,359,389,349,383,350,385,348" shape="poly">
            <area target="" alt="Bourgogne" title="Bourgogne" href="<?=$mode.$language?>&region=27#formulaire" coords="375,343,379,334,374,322,373,309,371,300,371,289,366,280,373,278,375,269,379,263,374,254,376,244,385,240,391,240,399,246,401,253,409,257,412,264,416,268,424,270,432,270,440,267,448,266,453,270,459,278,461,285,470,290,477,289,485,286,491,284,496,275,502,268,509,265,515,268,524,272,532,268,537,275,543,278,548,283,551,290,555,296,545,300,543,305,549,308,546,314,539,318,535,322,531,329,524,330,523,337,522,343,515,349,507,353,507,363,507,368,497,372,481,375,465,359,451,378,443,375,417,380,407,358,389,349,383,350,385,348" shape="poly">
            <area target="" alt="Centre" title="Centre" href="<?=$mode.$language?>&region=24#formulaire" coords="299,366,307,366,316,364,329,363,336,363,344,361,352,355,360,346,369,341,377,335,377,325,373,315,370,306,370,297,369,288,367,280,374,272,378,263,373,257,367,255,359,253,351,253,349,241,342,243,336,243,329,245,326,235,321,233,318,223,313,217,309,207,303,211,297,213,288,212,282,217,280,224,284,235,279,247,281,264,277,275,270,285,254,291,252,299,249,306,245,317,282,342,271,330" shape="poly">
            <area target="" alt="Grand Est" title="Grand Est" href="<?=$mode.$language?>&region=44#formulaire" coords="392,236,395,227,394,221,393,212,397,204,401,197,402,188,408,187,401,179,407,176,415,173,421,175,420,159,425,155,427,144,427,134,434,137,439,134,447,133,449,124,456,122,454,128,453,134,454,139,454,146,460,146,465,149,469,153,473,159,479,159,483,165,491,163,496,166,503,169,511,165,517,167,523,169,528,173,531,180,532,188,537,191,544,187,550,191,559,191,565,187,569,192,575,195,584,195,591,197,597,201,595,210,591,214,586,221,582,226,579,237,578,245,572,257,574,264,570,274,571,283,571,290,567,295,560,300,535,267,522,270,503,267,489,285,473,289,460,283,452,263,438,270,420,271,399,249,395,243,394,241" shape="poly">
            <area target="" alt="Île-de-France" title="Île-de-France" href="<?=$mode.$language?>&region=11#formulaire" coords="311,207,308,195,316,192,321,182,328,186,333,189,339,185,345,188,355,192,363,194,372,194,383,195,385,200,391,206,395,211,398,222,397,229,393,239,383,241,378,245,373,256,359,256,349,245,334,245,323,232" shape="poly">
            <area target="" alt="Hauts-de-France" title="Hauts-de-France" href="<?=$mode.$language?>&region=32#formulaire" coords="300,125,307,117,313,118,311,108,310,100,313,87,313,76,319,69,324,64,334,64,342,59,351,60,355,67,355,73,361,81,366,83,373,81,380,81,384,87,385,98,394,99,400,99,402,109,410,109,419,109,425,114,422,121,424,129,420,134,426,139,424,149,425,157,418,164,419,171,407,175,401,179,404,187,398,191,398,198,393,211,377,192,367,192,356,191,344,187,336,184,320,188,317,161,320,143,319,143,321,142" shape="poly">
            <area target="" alt="Normandie" title="Normandie" href="<?=$mode.$language?>&region=28#formulaire" coords="295,132,307,125,312,135,322,146,319,151,318,164,320,178,316,191,308,196,308,204,301,209,286,214,280,220,282,230,284,236,278,240,279,251,270,246,261,240,258,232,250,236,242,237,238,229,232,229,223,229,215,233,206,230,198,232,189,228,181,233,177,223,180,215,178,202,174,191,172,182,170,172,165,166,165,157,162,150,175,153,184,149,192,168,217,176,229,175,241,177,259,168,247,165,252,152" shape="poly">
            <area target="" alt="Bretagne" title="Bretagne" href="<?=$mode.$language?>&region=53#formulaire" coords="172,220,165,223,157,218,151,222,146,224,135,224,125,228,118,220,107,208,92,208,89,215,77,216,75,223,65,219,53,220,43,228,37,235,39,240,50,242,58,243,44,246,56,258,45,256,39,260,49,264,57,272,65,272,75,271,80,278,89,275,92,280,99,280,105,286,111,286,118,288,127,288,120,294,128,294,135,296,141,296,147,293,155,282,165,283,171,274,182,274,190,261,196,253,195,230,181,233" shape="poly">
            <area target="" alt="Pays de la Loire" title="Pays de la Loire" href="<?=$mode.$language?>&region=52#formulaire" coords="196,230,208,234,218,232,232,232,243,236,244,240,252,234,259,237,262,244,274,250,280,258,280,266,276,271,275,278,269,280,269,287,261,286,255,289,250,295,250,302,248,309,242,318,236,319,225,320,216,325,211,329,209,337,214,345,216,352,216,360,213,368,192,373,164,365,158,339,156,327,147,311,132,307,134,301,148,297,154,284,167,287,171,276,182,280,192,257,189,272,192,250,193,246,191,238,194,260,197,257" shape="poly">
            <area target="" alt="Centre-Val de Loire" title="Centre-Val de Loire" href="<?=$mode.$language?>&region=24#formulaire" coords="299,366,307,366,316,364,329,363,336,363,344,361,352,355,360,346,369,341,377,335,377,325,373,315,370,306,370,297,369,288,367,280,374,272,378,263,373,257,367,255,359,253,351,253,349,241,342,243,336,243,329,245,326,235,321,233,318,223,313,217,309,207,303,211,297,213,288,212,282,217,280,224,284,235,279,247,281,264,277,275,270,285,254,291,252,299,249,306,245,317,282,342,271,330" shape="poly">
            <area target="" alt="Corse" title="Corse" href="<?=$mode.$language?>&region=94#formulaire" coords="612,576,619,571,626,573,630,566,630,558,636,556,636,562,636,568,635,573,635,578,637,583,637,588,638,593,640,599,639,604,637,610,634,614,632,619,632,625,631,630,628,635,627,642,624,649,618,645,605,637,610,631,600,627,606,622,599,619,605,607,602,598,598,593,609,576" shape="poly">
        </map>
    </section>

    <section id="formulaire">
        <h2>Choisir votre département et ville</h2>
        <form action="previsions.php#formulaire" method="GET">
            <!-- Sélection de la région -->
            <label for="region">Région</label>
            <select name="region" id="region" onchange="this.form.submit()">
                <option value="">Sélectionnez une région</option>
                <?php
                $selectedRegion = $_GET['region'] ?? '';
                generateRegionOption($selectedRegion);
                ?>
            </select>




            <!-- Champs cachés pour conserver les valeurs sélectionnées -->
            <input type="hidden" name="region_hidden" value="<?= htmlspecialchars($selectedRegion) ?>">
        </form>

        <form action="previsions.php#formulaire" method="GET" >
            <!-- Conserver la région sélectionnée -->
            <input type="hidden" name="region" value="<?= htmlspecialchars($_GET['region'] ?? '') ?>">

            <label for="departement">Département</label>
            <select name="departement" id="departement" onchange="this.form.submit()">
                <option value="">Sélectionnez un département</option>
                <?php
                $selectedDepartment = $_GET['departement'] ?? '';
                if (!empty($_GET['region'])) {
                    generateDepartmentOption($_GET['region'], $selectedDepartment);
                }
                ?>
            </select>
        </form>


        <form action="previsions_ville.php" method="GET">
            <!-- Conserver région et département -->
            <input type="hidden" name="region" value="<?= htmlspecialchars($_GET['region'] ?? '') ?>">
            <input type="hidden" name="departement" value="<?= htmlspecialchars($_GET['departement'] ?? '') ?>">

            <label for="ville">Ville</label>
            <select name="ville" id="ville">
                <option value="">Sélectionnez une ville</option>
                <?php
                if (!empty($_GET['departement'])) {
                    generateCityOption($_GET['departement']);
                }
                ?>
            </select>
            <button type="submit">Valider</button>
        </form>


    </section>

<?php
require "./include/footer.inc.php";
?>
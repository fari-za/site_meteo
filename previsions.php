<?php
$title="Prévisions";
$description="La page des prévisions ";
$h1="Choisir votre ville pour voir les previsions détaillées ";
require_once "./include/functions.inc.php";
require "./include/header.inc.php";


?>

    <section>
        <h2>Choisir votre région</h2>

        <!-- Image Map Generated by http://www.image-map.net/ -->
        <img src="./images/carte-des-regions-et-departements-france-removebg.png" usemap="#image-map" style="display: block; margin: 0 auto;" alt="carte-des-regions-et-departements" />

        <map name="image-map" id="image-map">
            <area alt="Nouvelle" title="Nouvelle-Aquitaine" href="<?=$mode?>&amp;region=75#formulaire" coords="501,490,470,486,468,493,453,490,446,494,430,492,431,483,414,471,414,463,401,445,401,436,394,432,386,439,376,438,376,430,361,417,348,427,344,423,333,422,330,428,319,426,320,434,300,433,306,447,311,448,313,465,315,479,315,486,320,488,314,496,305,497,293,496,290,493,283,495,281,500,273,508,267,506,256,503,256,498,252,499,255,506,266,513,275,511,283,520,283,531,279,538,278,544,272,545,272,539,273,533,272,527,266,526,261,519,259,521,263,531,271,536,272,543,272,553,289,565,302,579,306,597,303,601,293,583,278,567,265,643,271,640,278,645,281,653,268,656,254,709,247,744,240,756,235,765,223,773,226,777,232,781,239,778,249,784,241,800,249,804,249,796,257,795,257,803,278,813,293,813,294,821,303,830,316,829,323,825,321,824,324,808,333,799,343,785,345,771,340,772,342,766,338,762,338,758,328,755,329,744,332,742,332,726,340,723,343,717,350,727,355,719,362,717,371,718,378,713,387,713,394,716,397,715,403,706,406,705,399,706,406,703,403,706,406,703,501,489,514,504,522,528,508,546,515,552,523,558,513,567,515,587,506,589,498,598,488,624,479,625,469,630,457,621,443,624,446,643,426,660,415,667,419,683,408,688,410,696,501,489" shape="poly" />
            <area alt="Occitanie" title="Occitanie" href="<?=$mode?>&amp;region=76#formulaire" coords="324,817,325,810,335,802,345,786,345,772,342,772,345,769,339,762,339,758,328,756,329,747,332,743,332,726,340,724,344,719,348,724,350,728,355,720,361,718,372,719,380,714,388,714,392,718,398,715,401,706,407,706,413,694,408,689,411,683,420,684,416,669,441,646,442,625,459,622,469,634,477,628,489,629,492,640,492,655,497,660,513,658,523,647,524,640,533,633,537,639,542,638,550,659,558,638,564,638,567,631,575,629,584,641,589,643,592,637,610,649,610,662,615,666,618,676,623,680,624,687,632,688,637,693,644,688,648,693,653,687,661,688,669,699,668,708,677,718,666,730,665,746,656,748,651,754,654,758,641,769,633,768,628,762,619,761,603,777,598,777,588,786,578,786,568,795,555,814,555,857,563,866,559,870,552,862,540,870,529,870,528,877,518,876,503,867,494,870,484,876,474,864,465,864,464,857,470,856,461,849,447,847,444,852,437,842,424,842,424,836,417,833,407,834,401,828,397,826,390,827,389,840,372,842,368,838,363,842,356,839,342,840,333,836,322,825" shape="poly" />
            <area alt="Provence-Alpes-Côte d'Azur" title="Provence-Alpes-Côte d'Azur" href="<?=$mode?>&amp;region=93#formulaire" coords="643,768,661,769,664,779,680,780,679,772,688,773,694,780,707,781,712,777,719,783,719,791,732,792,738,792,748,804,757,799,763,802,797,791,804,789,806,783,801,781,805,774,810,772,811,766,817,766,822,757,827,752,837,751,837,744,843,744,862,728,860,724,873,704,874,697,868,693,859,698,847,696,825,688,823,682,817,677,814,665,818,658,819,649,824,646,821,640,821,632,812,633,803,626,803,617,799,617,795,608,788,607,781,614,777,607,771,607,769,614,774,619,776,629,764,632,744,647,741,655,731,654,731,664,729,670,720,670,720,678,731,684,737,689,737,695,724,707,703,695,702,688,689,690,692,684,688,679,681,679,680,686,687,689,686,693,679,694,677,686,662,686,669,700,670,707,679,717,667,730,666,746,656,748,651,754,655,758" shape="poly" />
            <area alt="Auvergne" title="Auvergne-Rhone-Alpes" href="<?=$mode?>&amp;region=84#formulaire" coords="780,611,787,606,796,608,798,601,809,601,817,594,823,594,822,583,828,576,817,570,816,556,803,550,801,536,810,535,816,531,816,524,810,519,805,518,805,510,800,510,799,501,803,496,797,490,798,484,782,484,776,488,769,488,765,493,769,500,758,508,746,511,746,504,754,500,756,490,750,484,740,499,730,500,723,494,714,499,701,484,693,478,686,480,677,477,668,508,658,500,642,500,639,509,634,513,617,512,610,509,610,502,615,496,616,487,609,478,600,477,591,459,581,466,576,461,567,461,563,467,555,456,545,454,543,460,532,459,524,466,524,475,520,481,509,479,502,488,506,501,514,501,518,511,522,520,525,528,525,530,509,547,524,562,514,568,516,574,516,588,509,590,499,599,498,610,489,626,492,638,492,654,497,658,511,657,521,646,522,638,533,631,536,637,542,636,549,655,558,635,562,636,566,630,575,629,582,638,587,641,591,635,610,646,610,660,615,664,618,672,623,678,624,684,633,686,636,691,643,685,648,689,653,685,659,685,676,685,678,691,685,691,679,687,680,678,687,679,692,682,690,688,701,687,703,694,723,706,735,695,734,688,721,681,718,671,727,669,731,664,730,653,740,653,762,632,775,628,774,619,768,616,770,606,777,604" shape="poly" />
            <area alt="Bourgogne" title="Bourgogne-Franche-Comté" href="<?=$mode?>&amp;region=27#formulaire" coords="751,483,756,473,753,471,774,451,774,432,780,428,786,428,804,405,803,401,807,400,810,393,799,393,802,385,807,384,807,378,815,378,812,370,806,370,808,364,808,357,794,350,779,340,772,343,766,338,752,338,748,333,732,342,722,352,721,367,705,366,696,376,690,371,682,370,672,361,676,355,660,337,649,336,648,342,633,347,625,344,606,344,601,334,600,327,589,322,589,315,576,305,551,305,550,318,547,319,545,324,557,336,558,344,549,351,551,358,540,365,546,379,541,387,544,392,542,404,548,409,549,424,554,432,555,453,563,464,567,459,575,460,581,465,591,458,599,475,609,477,616,486,615,496,610,502,611,507,616,511,633,512,639,509,641,500,658,499,668,507,676,477,686,479,693,477,702,483,714,499,722,493,729,499,740,498" shape="poly" />
            <area alt="Centre" title="Centre-Val-De-Loire" href="<?=$mode?>&amp;region=24#formulaire" coords="554,453,541,458,532,459,526,463,525,473,519,478,509,478,503,486,470,485,466,493,452,486,446,491,430,490,430,481,415,471,413,462,400,445,400,436,393,432,385,437,376,437,377,428,362,416,371,385,369,376,382,379,382,371,395,366,411,344,416,326,407,311,415,304,421,301,421,287,412,276,430,266,442,266,455,251,459,261,459,274,473,297,481,298,483,311,495,310,510,308,519,319,514,327,530,328,543,324,556,337,557,345,549,348,549,356,541,363,546,377,541,385,545,391,541,404,548,409,549,426,556,431" shape="poly" />
            <area alt="Grand Est" title="Grand Est" href="<?=$mode?>&amp;region=44#formulaire" coords="807,368,812,368,817,373,816,378,820,382,831,382,836,379,843,366,837,360,842,330,839,317,849,296,845,291,849,283,850,270,866,251,872,234,859,232,837,230,831,228,827,217,820,217,818,223,800,224,794,217,787,217,788,222,781,222,771,210,771,204,763,195,755,195,752,193,746,193,741,198,733,197,719,189,701,193,699,187,680,172,662,167,658,152,661,136,658,135,652,150,637,157,622,153,625,172,616,180,613,209,590,214,591,229,590,246,577,258,577,277,581,282,575,290,575,304,589,314,590,321,600,327,601,333,607,343,624,343,634,347,647,341,648,335,658,335,676,354,673,360,682,368,689,369,696,374,704,365,720,366,721,352,732,341,748,332,751,337,766,337,771,342,777,338,795,349,807,356" shape="poly" />
            <area alt="Île-de-France" title="Île-de-France" href="<?=$mode?>&amp;region=11#formulaire" coords="466,221,462,236,450,236,457,249,459,260,460,271,472,295,481,297,485,310,495,307,511,309,520,319,516,324,526,327,534,326,542,323,547,318,548,305,574,302,575,289,581,282,577,274,577,256,569,249,555,234,530,239,507,227,491,227,488,227,472,229" shape="poly" />
            <area alt="Hauts-de-France" title="Hauts-de-France" href="<?=$mode?>&amp;region=32#formulaire" coords="576,256,589,244,588,212,613,207,614,181,624,170,619,150,620,124,609,116,594,116,587,118,586,105,575,99,565,101,562,84,556,75,545,78,542,84,531,73,522,64,525,61,519,47,493,57,463,66,460,111,460,128,451,144,470,173,468,207,475,221,467,221,472,230,480,229,489,227,492,229,507,228,531,240,554,235,568,250" shape="poly" />
            <area alt="Normandie" title="Normandie" href="<?=$mode?>&amp;region=28#formulaire" coords="466,220,474,219,467,205,470,171,451,144,432,157,399,162,375,177,368,195,380,202,372,204,360,216,347,217,340,210,315,210,306,205,297,203,293,207,281,188,285,179,278,174,265,178,246,169,247,174,246,169,250,180,251,184,248,188,252,201,264,219,263,261,274,271,274,276,262,276,265,286,271,290,280,283,292,289,305,288,311,293,320,289,320,295,328,290,342,289,345,283,350,284,350,294,355,302,366,302,377,291,385,298,385,305,395,315,400,316,405,321,412,321,408,310,412,305,422,299,422,287,412,275,431,266,445,266,456,251,452,238,462,237" shape="poly" />
            <area alt="Bretagne" title="Bretagne" href="<?=$mode?>&amp;region=53#formulaire" coords="293,290,280,284,273,292,263,285,262,276,246,276,244,268,237,269,235,277,229,272,226,276,218,277,212,270,191,282,168,247,146,250,138,250,138,260,130,259,122,257,119,266,108,256,76,262,76,266,61,268,57,288,68,287,86,281,84,290,92,292,92,298,72,294,72,302,88,301,88,313,80,313,60,315,76,325,81,339,90,338,95,334,106,334,111,344,123,344,126,347,132,347,137,352,146,354,156,367,184,367,184,372,174,374,175,376,198,376,197,382,208,379,216,378,221,376,222,365,237,360,250,361,265,349,277,355,284,337,292,336,288,311,292,305" shape="poly" />
            <area alt="Pays de la Loire" title="Pays de la Loire" href="<?=$mode?>&amp;region=52#formulaire" coords="411,322,405,323,400,317,394,316,385,307,383,298,377,292,366,304,355,302,349,293,349,284,345,283,343,289,327,290,320,296,320,288,310,294,305,289,293,289,292,303,289,311,294,336,283,337,278,355,265,351,251,361,237,361,223,366,222,376,217,381,208,379,198,383,195,389,202,402,209,403,216,397,230,399,229,404,218,403,217,410,214,415,221,417,227,425,217,438,216,443,234,466,234,474,249,484,254,484,260,489,260,492,266,491,273,498,278,495,293,490,293,497,313,497,319,489,314,487,315,480,310,449,307,448,299,433,319,433,319,426,329,427,333,422,345,423,350,427,360,417,366,399,371,386,371,376,384,380,383,373,396,369,412,345,415,327" shape="poly" />
            <area alt="Centre-Val de Loire" title="Centre-Val de Loire" href="<?=$mode?>&amp;region=24#formulaire" coords="554,453,541,458,532,459,526,463,525,473,519,478,509,478,503,486,470,485,466,493,452,486,446,491,430,490,430,481,415,471,413,462,400,445,400,436,393,432,385,437,376,437,377,428,362,416,371,385,369,376,382,379,382,371,395,366,411,344,416,326,407,311,415,304,421,301,421,287,412,276,430,266,442,266,455,251,459,261,459,274,473,297,481,298,483,311,495,310,510,308,519,319,514,327,530,328,543,324,556,337,557,345,549,348,549,356,541,363,546,377,541,385,545,391,541,404,548,409,549,426,556,431" shape="poly" />
            <area alt="Corse" title="Corse" href="<?=$mode?>&amp;region=94#formulaire" coords="849,955,854,905,864,885,851,802,843,802,843,831,827,831,796,857,796,885,804,890,803,902,811,907,807,923,819,928,816,936,837,955" shape="poly" />
            <area alt="Guadeloupe " title="Guadeloupe " href="<?=$mode?>&amp;region=94#formulaire" coords="78,503,74,513,74,520,78,531,81,540,86,546,95,544,100,537,99,520,109,517,126,515,136,509,125,500,120,489,111,482,104,489,108,498,104,506,89,504,82,497" shape="poly" />
            <area alt="Martinique" title="Martinique" href="<?=$mode?>&amp;region=94#formulaire" coords="111,628,100,627,87,610,87,598,98,596,108,600,114,611,125,607,122,618,126,624,130,634,133,642,129,649,120,644,109,644,100,638" shape="poly" />
            <area alt="Guyane" title="Guyane" href="<?=$mode?>&amp;region=94#formulaire" coords="94,687,75,701,78,717,88,736,76,764,85,770,102,763,109,770,122,761,128,744,140,727,138,713,115,697" shape="poly" />
            <area alt="La Réunion " title="La Réunion " href="<?=$mode?>&amp;region=94#formulaire" coords="138,834,123,818,120,807,89,800,80,809,72,818,83,845,109,860,136,851" shape="poly" />
            <area alt="Mayotte" title="Mayotte" href="<?=$mode?>&amp;region=94#formulaire" coords="91,892,78,905,79,915,85,920,93,920,92,927,91,936,94,941,101,950,101,962,93,960,85,953,89,965,93,974,101,978,109,978,109,968,119,951,112,940,119,927,124,918,112,910,101,909" shape="poly" />
        </map>

    </section>

    <section id="formulaire">
        <h2>Choisir votre département et ville</h2>
        <form action="previsions.php#formulaire" method="GET">
            <!-- Sélection de la région -->
            <label for="region">Région</label>
            <select name="region" id="region" onchange="this.form.submit()">
                <option value="">Sélectionnez une région</option>
                <?php
                $selectedRegion = $_GET['region'] ?? '';
                generateRegionOption($selectedRegion);
                ?>
            </select>


            <!-- Champs cachés pour conserver les valeurs sélectionnées -->
            <input type="hidden" name="region_hidden" value="<?= htmlspecialchars($selectedRegion) ?>" />
        </form>

        <form action="previsions.php#formulaire" method="GET" >
            <!-- Conserver la région sélectionnée -->
            <input type="hidden" name="region" value="<?= htmlspecialchars($_GET['region'] ?? '') ?>" />

            <label for="departement">Département</label>
            <select name="departement" id="departement" onchange="this.form.submit()">
                <option value="">Sélectionnez un département</option>
                <?php
                $selectedDepartment = $_GET['departement'] ?? '';
                if (!empty($_GET['region'])) {
                    generateDepartmentOption($_GET['region'], $selectedDepartment);
                }
                ?>
            </select>
        </form>


        <form action="previsions_ville.php" method="GET">
            <!-- Conserver région et département -->
            <input type="hidden" name="region" value="<?= htmlspecialchars($_GET['region'] ?? '') ?>" />
            <input type="hidden" name="departement" value="<?= htmlspecialchars($_GET['departement'] ?? '') ?>" />

            <label for="ville">Ville</label>
            <select name="ville" id="ville">
                <option value="">Sélectionnez une ville</option>
                <?php
                if (!empty($_GET['departement'])) {
                    generateCityOption($_GET['departement']);
                }
                ?>
            </select>
            <button type="submit">Valider</button>
        </form>

    </section>

<?php
 require "./include/footer.inc.php";
?>